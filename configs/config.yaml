# Main configuration file
defaults:
  - model: combined
  - data: imagenet_c
  - trainer: default
  - experiment: null  # Override with experiment configs
  - _self_

# Paths
work_dir: ${hydra:runtime.output_dir}
data_root: "/mnt/bit/data/imagenet-c/"  # UPDATE THIS

# Experiment settings
seed: 42
experiment_name: "4e-5_kendall_topk8_temp-1.0"

# TTA settings
tta:
  continual: false  # If false, reset model between tasks
  update_auxiliary: true  # Update generative model
  update_task_norm_only: false  # Only update task model norms
  forward_mode: "normed_logits_with_logits"  # DUSA default
  # forward_mode: "logits"  # Disable auxiliary model


# Optimizer settings
optimizer:
  learning_rate: 4e-5
  weight_decay: 0.0

# Logging
logging:
  use_wandb: true
  wandb_project: "dusa-tta"
  wandb_entity: "lyxszn-beihang-university"  # Set to your W&B username/team
  log_aux_metrics: false  # Log auxiliary metrics (loss_top_i, auc, etc.) - disabled by default
  enable_sample_logging: true  # Toggle per-sample CSV logging
  sample_log_dir: "${work_dir}/sample_logs"  # Per-experiment sample-level CSV outputs

# Hydra settings
hydra:
  run:
    dir: outputs/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: multirun/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}
