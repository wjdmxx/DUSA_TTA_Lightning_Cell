# Main configuration file
defaults:
  - model: combined
  - data: imagenet_c
  - trainer: default
  - experiment: null  # Override with experiment configs
  - _self_

# Paths
work_dir: ${hydra:runtime.output_dir}
data_root: "/mnt/bit/data/imagenet-c/"  # UPDATE THIS

# Experiment settings
seed: 42
experiment_name: "timm_in1k_4e-5_dusa_shuffle_8x8_norm_l2_adaptive_weight_only_pos_1.5"

# TTA settings
tta:
  continual: false  # If false, reset model between tasks
  update_auxiliary: true  # Update generative model
  update_task_norm_only: false  # Only update task model norms
  forward_mode: "normed_logits_with_logits"  # DUSA default
  # forward_mode: "logits"  # Disable auxiliary model


# Optimizer settings
optimizer:
  learning_rate: 4e-5
  weight_decay: 0.0

# Logging
logging:
  use_wandb: true
  wandb_project: "dusa-tta"
  wandb_entity: "lyxszn-beihang-university"  # Set to your W&B username/team
  log_aux_metrics: false  # Log auxiliary metrics (loss_top_i, auc, etc.) - disabled by default

# Hydra settings
hydra:
  run:
    dir: outputs/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
  sweep:
    dir: multirun/${experiment_name}/${now:%Y-%m-%d}/${now:%H-%M-%S}
    subdir: ${hydra.job.num}
