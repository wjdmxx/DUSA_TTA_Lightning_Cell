# Discriminative model: ConvNeXt-Large
discriminative:
  model_name: "convnext_large.fb_in1k"
  pretrained: true
  checkpoint_path: null  # Set to custom checkpoint path if needed
  num_classes: 1000
  # Normalization settings (applied in model forward)
  normalize_mean: [0.485, 0.456, 0.406]  # ImageNet mean
  normalize_std: [0.229, 0.224, 0.225]   # ImageNet std

# Pixel Adapter: shared between discriminative and generative branches
# Lives in CombinedModel, applied before both branches
# pixel_adapter:
#   type: "standard"
#   in_channels: 3
#   hidden_channels: 64
#   num_blocks: 3
#   max_scale: 0.15
#   use_spatial_attention: true

# Generative model: REPA SiT
generative:
  sit_model_name: "SiT-XL/2"  # SiT-XL/2 or SiT-B/2
  sit_checkpoint: "/mnt/bit/liyuanxi/projects/DUSA_flow/classification/pretrained_models/REPA-SiT-XL-2-256.pt"  # UPDATE THIS
  num_classes: 1000
  
  # VAE settings
  vae_pretrained: "stabilityai/sd-vae-ft-ema"
  vae_scaling_factor: 0.18215
  
  # Loss settings
  topk: 4
  rand_budget: 2
  temperature: 1.0
  sample_reverse_logits: false
  adaptive_loss_weight: false
  kendall_topk: 8
  kendall_gate_only: true
  kendall_temperature: -1.0

  # Scheduler settings
  scheduler_type: "linear"  # linear or reverse_linear
  # Timestep policy (set to "uniform" to disable contextual bandit)
  time_sampler_type: "contextual_linucb"
  time_sampler_kwargs:
    time_candidates: [0.0821, 0.1111, 0.1345, 0.1558, 0.1763, 0.1967, 0.2174, 0.2389, 0.2615, 0.2857, 0.3121, 0.3417, 0.3758, 0.4170, 0.4707, 0.5541]
    alpha: 2.0
    lambda_reg: 1.0
    gamma: 0.995
    update_interval: 1
    high_freq_ratio: 0.25
    include_energy: true
    feature_eps: 1.0e-6
